2025-09-09 16:17:20,054 - INFO - 开始训练 MADDPG...
2025-09-09 16:17:20,054 - INFO - 日志目录: log/train_2025-09-09-16-17
2025-09-09 16:17:20,054 - INFO - 配置文件已保存到: log/train_2025-09-09-16-17/config.json
2025-09-09 16:17:20,054 - INFO - 配置参数: {'map': {'kMaxX': 5.0, 'kMaxY': 5.0, 'kMinX': -5.0, 'kMinY': -5.0, 'kMaxObsR': 1.0, 'kMinObsR': 0.3, 'kNumAgents': 2, 'kNumGoals': 5, 'kNumObstacles': 3, 'kTimeStep': 0.1}, 'agent': {'kAgentRadius': 0.2, 'kMaxSpeed': 1.0, 'kMaxAngularSpeed': 1.0, 'kNumRadars': 32, 'kMaxRadarDist': 3.0}, 'goal': {'kGoalThreshold': 0.3}, 'reward': {'kTimeReward': -0.1, 'kCollisionReward': -100.0, 'kGoalReward': 100.0, 'kDistanceReward': 0.1, 'kAgentSeparationReward': 0.1, 'kMinAgentDistance': 1.0, 'kMinGoalDistance': 0.1}, 'training': {'max_episodes': 1000, 'max_steps_per_episode': 500, 'buffer_size': 100000, 'batch_size': 256, 'learning_rate': 8e-05, 'lr_decay': 0.99, 'min_learning_rate': 1e-05, 'gamma': 0.95, 'tau': 0.01, 'noise_std': 0.1, 'noise_decay': 0.995, 'min_noise_std': 0.01, 'smart_noise_control': True, 'save_interval': 500, 'log_interval': 10, 'device': 'cuda'}}
2025-09-09 16:17:20,085 - INFO - 使用设备: cuda
2025-09-09 16:17:20,092 - INFO - 环境创建成功 - Agent数量: 2, 目标数量: 5, 障碍物数量: 3
2025-09-09 16:17:20,093 - INFO - 状态维度 - Agent状态: 3, 观测维度: 32, 动作维度: 2
2025-09-09 16:17:20,093 - INFO - 全局状态维度: 30, 最大动作: [1. 1.]
2025-09-09 16:17:21,366 - INFO - 智能体团队创建成功
2025-09-09 16:17:21,366 - INFO - 经验回放缓冲区创建成功
2025-09-09 16:17:21,366 - INFO - 保存初始环境状态图...
2025-09-09 16:17:22,057 - INFO - 初始环境状态图已保存到: images/initial_environment_state.png
2025-09-09 16:17:22,057 - INFO - 开始训练循环...
2025-09-09 16:17:26,885 - INFO - Episode 10/1000 - 平均奖励: -111.047, 平均步数: 43.9, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000080, 噪声标准差: 0.0951, 平均用时: 0.48s
2025-09-09 16:17:29,511 - INFO - Episode 20/1000 - 平均奖励: -99.982, 平均步数: 16.2, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000079, 噪声标准差: 0.0905, 平均用时: 0.26s
2025-09-09 16:17:32,017 - INFO - Episode 30/1000 - 平均奖励: -100.482, 平均步数: 16.2, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000078, 噪声标准差: 0.0860, 平均用时: 0.25s
2025-09-09 16:17:34,585 - INFO - Episode 40/1000 - 平均奖励: -100.480, 平均步数: 16.1, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000078, 噪声标准差: 0.0818, 平均用时: 0.26s
2025-09-09 16:17:37,205 - INFO - Episode 50/1000 - 平均奖励: -100.478, 平均步数: 16.1, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000077, 噪声标准差: 0.0778, 平均用时: 0.26s
2025-09-09 16:17:39,794 - INFO - Episode 60/1000 - 平均奖励: -100.479, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000076, 噪声标准差: 0.0740, 平均用时: 0.26s
2025-09-09 16:17:42,298 - INFO - Episode 70/1000 - 平均奖励: -100.460, 平均步数: 15.4, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000075, 噪声标准差: 0.0704, 平均用时: 0.25s
2025-09-09 16:17:43,910 - INFO - Episode 80/1000 - 平均奖励: -100.304, 平均步数: 9.8, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000075, 噪声标准差: 0.0670, 平均用时: 0.16s
2025-09-09 16:17:45,294 - INFO - Episode 90/1000 - 平均奖励: -100.129, 平均步数: 8.5, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000074, 噪声标准差: 0.0637, 平均用时: 0.14s
2025-09-09 16:17:46,608 - INFO - Episode 100/1000 - 平均奖励: -100.122, 平均步数: 8.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000073, 噪声标准差: 0.0606, 平均用时: 0.13s
2025-09-09 16:17:47,937 - INFO - Episode 110/1000 - 平均奖励: -100.144, 平均步数: 8.1, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000072, 噪声标准差: 0.0576, 平均用时: 0.13s
2025-09-09 16:17:49,255 - INFO - Episode 120/1000 - 平均奖励: -100.152, 平均步数: 8.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000072, 噪声标准差: 0.0548, 平均用时: 0.13s
2025-09-09 16:17:50,595 - INFO - Episode 130/1000 - 平均奖励: -130.196, 平均步数: 8.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000071, 噪声标准差: 0.0521, 平均用时: 0.13s
2025-09-09 16:17:51,946 - INFO - Episode 140/1000 - 平均奖励: -100.167, 平均步数: 8.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000070, 噪声标准差: 0.0496, 平均用时: 0.13s
2025-09-09 16:17:53,545 - INFO - Episode 150/1000 - 平均奖励: -100.223, 平均步数: 9.7, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000069, 噪声标准差: 0.0471, 平均用时: 0.16s
2025-09-09 16:17:55,353 - INFO - Episode 160/1000 - 平均奖励: -100.345, 平均步数: 11.1, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000069, 噪声标准差: 0.0448, 平均用时: 0.18s
2025-09-09 16:17:57,184 - INFO - Episode 170/1000 - 平均奖励: -100.347, 平均步数: 11.2, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000068, 噪声标准差: 0.0427, 平均用时: 0.18s
2025-09-09 16:17:59,760 - INFO - Episode 180/1000 - 平均奖励: -100.467, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000067, 噪声标准差: 0.0406, 平均用时: 0.26s
2025-09-09 16:18:02,383 - INFO - Episode 190/1000 - 平均奖励: -100.461, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000067, 噪声标准差: 0.0386, 平均用时: 0.26s
2025-09-09 16:18:05,007 - INFO - Episode 200/1000 - 平均奖励: -100.466, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000066, 噪声标准差: 0.0367, 平均用时: 0.26s
2025-09-09 16:18:07,646 - INFO - Episode 210/1000 - 平均奖励: -100.461, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000065, 噪声标准差: 0.0349, 平均用时: 0.26s
2025-09-09 16:18:10,241 - INFO - Episode 220/1000 - 平均奖励: -100.471, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000065, 噪声标准差: 0.0332, 平均用时: 0.26s
2025-09-09 16:18:12,836 - INFO - Episode 230/1000 - 平均奖励: -100.486, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000064, 噪声标准差: 0.0316, 平均用时: 0.26s
2025-09-09 16:18:15,448 - INFO - Episode 240/1000 - 平均奖励: -100.500, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000063, 噪声标准差: 0.0300, 平均用时: 0.26s
2025-09-09 16:18:18,062 - INFO - Episode 250/1000 - 平均奖励: -100.504, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000063, 噪声标准差: 0.0286, 平均用时: 0.26s
2025-09-09 16:18:20,665 - INFO - Episode 260/1000 - 平均奖励: -100.504, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000062, 噪声标准差: 0.0272, 平均用时: 0.26s
2025-09-09 16:18:23,298 - INFO - Episode 270/1000 - 平均奖励: -100.499, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000062, 噪声标准差: 0.0258, 平均用时: 0.26s
2025-09-09 16:18:25,912 - INFO - Episode 280/1000 - 平均奖励: -100.498, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000061, 噪声标准差: 0.0246, 平均用时: 0.26s
2025-09-09 16:18:28,345 - INFO - Episode 290/1000 - 平均奖励: -100.499, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000060, 噪声标准差: 0.0234, 平均用时: 0.24s
2025-09-09 16:18:30,736 - INFO - Episode 300/1000 - 平均奖励: -100.494, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000060, 噪声标准差: 0.0222, 平均用时: 0.24s
2025-09-09 16:18:33,271 - INFO - Episode 310/1000 - 平均奖励: -100.489, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000059, 噪声标准差: 0.0211, 平均用时: 0.25s
2025-09-09 16:18:35,822 - INFO - Episode 320/1000 - 平均奖励: -100.477, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000059, 噪声标准差: 0.0201, 平均用时: 0.26s
2025-09-09 16:18:38,444 - INFO - Episode 330/1000 - 平均奖励: -100.472, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000058, 噪声标准差: 0.0191, 平均用时: 0.26s
2025-09-09 16:18:40,921 - INFO - Episode 340/1000 - 平均奖励: -100.484, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000057, 噪声标准差: 0.0182, 平均用时: 0.25s
2025-09-09 16:18:43,473 - INFO - Episode 350/1000 - 平均奖励: -100.485, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000057, 噪声标准差: 0.0173, 平均用时: 0.26s
2025-09-09 16:18:45,907 - INFO - Episode 360/1000 - 平均奖励: -100.494, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000056, 噪声标准差: 0.0165, 平均用时: 0.24s
2025-09-09 16:18:48,264 - INFO - Episode 370/1000 - 平均奖励: -100.499, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000056, 噪声标准差: 0.0157, 平均用时: 0.24s
2025-09-09 16:18:50,704 - INFO - Episode 380/1000 - 平均奖励: -100.503, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000055, 噪声标准差: 0.0149, 平均用时: 0.24s
2025-09-09 16:18:53,034 - INFO - Episode 390/1000 - 平均奖励: -100.504, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000055, 噪声标准差: 0.0142, 平均用时: 0.23s
2025-09-09 16:18:55,455 - INFO - Episode 400/1000 - 平均奖励: -100.505, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000054, 噪声标准差: 0.0135, 平均用时: 0.24s
2025-09-09 16:18:57,807 - INFO - Episode 410/1000 - 平均奖励: -100.506, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000054, 噪声标准差: 0.0128, 平均用时: 0.24s
2025-09-09 16:19:00,160 - INFO - Episode 420/1000 - 平均奖励: -100.506, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000053, 噪声标准差: 0.0122, 平均用时: 0.24s
2025-09-09 16:19:02,641 - INFO - Episode 430/1000 - 平均奖励: -100.486, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000052, 噪声标准差: 0.0116, 平均用时: 0.25s
2025-09-09 16:19:05,098 - INFO - Episode 440/1000 - 平均奖励: -100.484, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000052, 噪声标准差: 0.0110, 平均用时: 0.25s
2025-09-09 16:19:07,498 - INFO - Episode 450/1000 - 平均奖励: -100.490, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000051, 噪声标准差: 0.0105, 平均用时: 0.24s
2025-09-09 16:19:10,106 - INFO - Episode 460/1000 - 平均奖励: -100.494, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000051, 噪声标准差: 0.0100, 平均用时: 0.26s
2025-09-09 16:19:12,635 - INFO - Episode 470/1000 - 平均奖励: -100.477, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000050, 噪声标准差: 0.0100, 平均用时: 0.25s
2025-09-09 16:19:15,219 - INFO - Episode 480/1000 - 平均奖励: -100.461, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000050, 噪声标准差: 0.0100, 平均用时: 0.26s
2025-09-09 16:19:17,626 - INFO - Episode 490/1000 - 平均奖励: -100.455, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000049, 噪声标准差: 0.0100, 平均用时: 0.24s
2025-09-09 16:19:20,007 - INFO - Episode 500/1000 - 平均奖励: -100.442, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000049, 噪声标准差: 0.0100, 平均用时: 0.24s
2025-09-09 16:19:20,013 - INFO - 模型已保存到 models/episode_500_sr_0.000 - 定期保存（500轮间隔）
2025-09-09 16:19:22,702 - INFO - Episode 510/1000 - 平均奖励: -100.449, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000048, 噪声标准差: 0.0100, 平均用时: 0.27s
2025-09-09 16:19:25,271 - INFO - Episode 520/1000 - 平均奖励: -100.449, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000048, 噪声标准差: 0.0100, 平均用时: 0.26s
2025-09-09 16:19:27,703 - INFO - Episode 530/1000 - 平均奖励: -100.451, 平均步数: 16.0, 成功率: 0.000, 平均完成任务点: 0.00, 学习率: 0.000047, 噪声标准差: 0.0100, 平均用时: 0.24s
